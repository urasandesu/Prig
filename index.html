<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Prig: Open Source Alternative to Microsoft Fakes By: @urasandesu</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Prig</h1>
        <p class="header">Open Source Alternative to Microsoft Fakes</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/urasandesu/Prig/releases/download/v0.0.0-alpha7/Prig-v0.0.0-alpha7.with.binary.zip">Download BIN</a></li>
          <li class="download"><a class="buttons" href="https://github.com/urasandesu/Prig/releases/download/v0.0.0-alpha7/Prig-v0.0.0-alpha7.zip">Download SRC</a></li>
          <li><a class="buttons github" href="https://github.com/urasandesu/Prig">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/urasandesu">urasandesu</a></p>


      </header>
      <section>
        <h1>
<a name="prig" class="anchor" href="#prig"><span class="octicon octicon-link"></span></a>Prig</h1>

<h2>
<a name="synopsis" class="anchor" href="#synopsis"><span class="octicon octicon-link"></span></a>SYNOPSIS</h2>

<p>Prig is a lightweight framework for test indirections in .NET Framework.</p>

<h2>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>DESCRIPTION</h2>

<p>Prig(PRototyping jIG) is a framework that generates a <a href="http://martinfowler.com/bliki/TestDouble.html">Test Double</a> like <a href="http://msdn.microsoft.com/en-us/library/hh549175.aspx">Microsoft Fakes</a>/<a href="http://www.typemock.com/isolator-product-page">Typemock Isolator</a>/<a href="http://www.telerik.com/products/mocking.aspx">Telerik JustMock</a> based on Unmanaged Profiler APIs.
This framework enables that any methods are replaced with mocks. For example, a static property, a private method, a non-virtual member and so on.</p>

<h2>
<a name="status" class="anchor" href="#status"><span class="octicon octicon-link"></span></a>STATUS</h2>

<p>As of July 27, 2014, Prig does not work completely. However, we steadily continue to develop at the private repository. This framework will come out within the year if everything goes well.</p>

<h2>
<a name="quick-tour" class="anchor" href="#quick-tour"><span class="octicon octicon-link"></span></a>QUICK TOUR</h2>

<p>Let's say you want to test the following code: </p>

<div class="highlight highlight-cs"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleApplication</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">LifeInfo</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">IsNowLunchBreak</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">now</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>
            <span class="k">return</span> <span class="m">12</span> <span class="p">&lt;=</span> <span class="n">now</span><span class="p">.</span><span class="n">Hour</span> <span class="p">&amp;&amp;</span> <span class="n">now</span><span class="p">.</span><span class="n">Hour</span> <span class="p">&lt;</span> <span class="m">13</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>You probably can't test this code, because <code>DateTime.Now</code> returns the value that depends on an external environment. To make be testable, you should replace <code>DateTime.Now</code> to the Test Double that returns the fake information. If you use Prig, it will enable you to generate a Test Double by the following steps without any editing the product code:</p>

<h3>
<a name="step-1-install-from-nuget" class="anchor" href="#step-1-install-from-nuget"><span class="octicon octicon-link"></span></a>Step 1: Install From NuGet</h3>

<p>Run Visual Studio 2013 as Administrator, add test project(e.g. <code>ConsoleApplicationTest</code>) and run the following command in the Package Manager Console: </p>

<div class="highlight highlight-powershell"><pre><span class="n">PM</span><span class="p">&gt;</span> <span class="n">Install-Package</span> <span class="n">Prig</span> <span class="n">-Pre</span>
</pre></div>

<h3>
<a name="step-2-add-stub-settings" class="anchor" href="#step-2-add-stub-settings"><span class="octicon octicon-link"></span></a>Step 2: Add Stub Settings</h3>

<p>Run the following command in the Package Manager Console: </p>

<div class="highlight highlight-powershell"><pre><span class="n">PM</span><span class="p">&gt;</span> <span class="nb">Add-PrigAssembly</span> <span class="n">-Assembly</span> <span class="s2">"mscorlib, Version=4.0.0.0"</span>
</pre></div>

<p>The command means to create the stub settings for the test indirection. The reason to specify <code>mscorlib</code> is that <code>DateTime.Now</code> belongs <code>mscorlib</code>. After the command is invoked, you will get the confirmation message that the project has been modified externally, so reload the project.</p>

<h3>
<a name="step-3-modify-stub-settings" class="anchor" href="#step-3-modify-stub-settings"><span class="octicon octicon-link"></span></a>Step 3: Modify Stub Settings</h3>

<p>You can find the setting file <code>&lt;assembly name&gt;.prig</code> in the project(in this case, it is <code>mscorlib.prig</code>). Modify the setting in accordance with the comment, then build all projects: </p>

<div class="highlight highlight-xml"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

  <span class="nt">&lt;configSections&gt;</span>
    <span class="nt">&lt;section</span> <span class="na">name=</span><span class="s">"prig"</span> <span class="na">type=</span><span class="s">"Urasandesu.Prig.Framework.PilotStubberConfiguration.PrigSection, Urasandesu.Prig.Framework"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/configSections&gt;</span>

  <span class="c">&lt;!-- </span>
<span class="c">      The content of tag 'RuntimeMethodInfo' is generated by NetDataContractSerializer.WriteObject(without explicit assembly version).</span>
<span class="c">      Specifically, you can generate it by the following PowerShell script in the Package Manager Console: </span>

<span class="c">      ========================== EXAMPLE 1 ==========================</span>
<span class="c">      PM&gt; $methods = Find-IndirectionTarget datetime get_Now</span>
<span class="c">      PM&gt; $methods</span>

<span class="c">      Method</span>
<span class="c">      ======</span>
<span class="c">      System.DateTime get_Now()</span>


<span class="c">      PM&gt; $methods[0] | Get-IndirectionStubSetting | clip</span>
<span class="c">      PM&gt;</span>

<span class="c">      Then, paste the clipboard content to between 'add' tags.</span>
<span class="c">  --&gt;</span>
  <span class="nt">&lt;prig&gt;</span>

    <span class="nt">&lt;stubs&gt;</span>
      <span class="c">&lt;!--</span>
<span class="c">      &lt;add name="$(This attribute is identifier. It's preferable that method's overloads can be recognized. If the method has just one signature, this can make be same as 'alias'.)" </span>
<span class="c">           alias="$(This attribute is an alias as its name suggests. You can use it in your test code.)"&gt;</span>
<span class="c">        $(Paste the result of 'Get-IndirectionStubSetting.ps1' here.)</span>
<span class="c">      &lt;/add&gt;</span>
<span class="c">      --&gt;</span>

      <span class="nt">&lt;add</span> <span class="na">name=</span><span class="s">"NowGet"</span> <span class="na">alias=</span><span class="s">"NowGet"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;RuntimeMethodInfo</span> <span class="na">xmlns:i=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:x=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">z:Id=</span><span class="s">"1"</span> <span class="na">z:FactoryType=</span><span class="s">"MemberInfoSerializationHolder"</span> <span class="na">z:Type=</span><span class="s">"System.Reflection.MemberInfoSerializationHolder"</span> <span class="na">z:Assembly=</span><span class="s">"0"</span> <span class="na">xmlns:z=</span><span class="s">"http://schemas.microsoft.com/2003/10/Serialization/"</span> <span class="na">xmlns=</span><span class="s">"http://schemas.datacontract.org/2004/07/System.Reflection"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Name</span> <span class="na">z:Id=</span><span class="s">"2"</span> <span class="na">z:Type=</span><span class="s">"System.String"</span> <span class="na">z:Assembly=</span><span class="s">"0"</span> <span class="na">xmlns=</span><span class="s">""</span><span class="nt">&gt;</span>get_Now<span class="nt">&lt;/Name&gt;</span>
          <span class="nt">&lt;AssemblyName</span> <span class="na">z:Id=</span><span class="s">"3"</span> <span class="na">z:Type=</span><span class="s">"System.String"</span> <span class="na">z:Assembly=</span><span class="s">"0"</span> <span class="na">xmlns=</span><span class="s">""</span><span class="nt">&gt;</span>mscorlib<span class="nt">&lt;/AssemblyName&gt;</span>
          <span class="nt">&lt;ClassName</span> <span class="na">z:Id=</span><span class="s">"4"</span> <span class="na">z:Type=</span><span class="s">"System.String"</span> <span class="na">z:Assembly=</span><span class="s">"0"</span> <span class="na">xmlns=</span><span class="s">""</span><span class="nt">&gt;</span>System.DateTime<span class="nt">&lt;/ClassName&gt;</span>
          <span class="nt">&lt;Signature</span> <span class="na">z:Id=</span><span class="s">"5"</span> <span class="na">z:Type=</span><span class="s">"System.String"</span> <span class="na">z:Assembly=</span><span class="s">"0"</span> <span class="na">xmlns=</span><span class="s">""</span><span class="nt">&gt;</span>System.DateTime get_Now()<span class="nt">&lt;/Signature&gt;</span>
          <span class="nt">&lt;Signature2</span> <span class="na">z:Id=</span><span class="s">"6"</span> <span class="na">z:Type=</span><span class="s">"System.String"</span> <span class="na">z:Assembly=</span><span class="s">"0"</span> <span class="na">xmlns=</span><span class="s">""</span><span class="nt">&gt;</span>System.DateTime get_Now()<span class="nt">&lt;/Signature2&gt;</span>
          <span class="nt">&lt;MemberType</span> <span class="na">z:Id=</span><span class="s">"7"</span> <span class="na">z:Type=</span><span class="s">"System.Int32"</span> <span class="na">z:Assembly=</span><span class="s">"0"</span> <span class="na">xmlns=</span><span class="s">""</span><span class="nt">&gt;</span>8<span class="nt">&lt;/MemberType&gt;</span>
          <span class="nt">&lt;GenericArguments</span> <span class="na">i:nil=</span><span class="s">"true"</span> <span class="na">xmlns=</span><span class="s">""</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/RuntimeMethodInfo&gt;</span>
      <span class="nt">&lt;/add&gt;</span>
    <span class="nt">&lt;/stubs&gt;</span>

  <span class="nt">&lt;/prig&gt;</span>

<span class="nt">&lt;/configuration&gt;</span>
</pre></div>

<h3>
<a name="step-4-make-tests" class="anchor" href="#step-4-make-tests"><span class="octicon octicon-link"></span></a>Step 4: Make Tests</h3>

<p>In the test code, it become testable through the use of the stub and the replacement to Test Double that returns the fake information.</p>

<div class="highlight highlight-cs"><pre><span class="k">using</span> <span class="nn">NUnit.Framework</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ConsoleApplication</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Prig</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Urasandesu.Prig.Framework</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleApplicationTest</span>
<span class="p">{</span>
<span class="na">    [TestFixture]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">LifeInfoTest</span>
    <span class="p">{</span>
<span class="na">        [Test]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">IsNowLunchBreak_should_return_false_when_11_oclock</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="k">new</span> <span class="n">IndirectionsContext</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="c1">// Arrange</span>
                <span class="n">PDateTime</span><span class="p">.</span><span class="n">NowGet</span><span class="p">().</span><span class="n">Body</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">DateTime</span><span class="p">(</span><span class="m">2013</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">13</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">00</span><span class="p">,</span> <span class="m">00</span><span class="p">);</span>

                <span class="c1">// Act</span>
                <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">LifeInfo</span><span class="p">.</span><span class="n">IsNowLunchBreak</span><span class="p">();</span>

                <span class="c1">// Assert</span>
                <span class="n">Assert</span><span class="p">.</span><span class="n">IsFalse</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

<span class="na">        [Test]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">IsNowLunchBreak_should_return_true_when_12_oclock</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="k">new</span> <span class="n">IndirectionsContext</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="c1">// Arrange</span>
                <span class="n">PDateTime</span><span class="p">.</span><span class="n">NowGet</span><span class="p">().</span><span class="n">Body</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">DateTime</span><span class="p">(</span><span class="m">2013</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">13</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">00</span><span class="p">,</span> <span class="m">00</span><span class="p">);</span>

                <span class="c1">// Act</span>
                <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">LifeInfo</span><span class="p">.</span><span class="n">IsNowLunchBreak</span><span class="p">();</span>

                <span class="c1">// Assert</span>
                <span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

<span class="na">        [Test]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">IsNowLunchBreak_should_return_false_when_13_oclock</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="k">new</span> <span class="n">IndirectionsContext</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="c1">// Arrange</span>
                <span class="n">PDateTime</span><span class="p">.</span><span class="n">NowGet</span><span class="p">().</span><span class="n">Body</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">DateTime</span><span class="p">(</span><span class="m">2013</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">13</span><span class="p">,</span> <span class="m">13</span><span class="p">,</span> <span class="m">00</span><span class="p">,</span> <span class="m">00</span><span class="p">);</span>

                <span class="c1">// Act</span>
                <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">LifeInfo</span><span class="p">.</span><span class="n">IsNowLunchBreak</span><span class="p">();</span>

                <span class="c1">// Assert</span>
                <span class="n">Assert</span><span class="p">.</span><span class="n">IsFalse</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="step-5-run-tests" class="anchor" href="#step-5-run-tests"><span class="octicon octicon-link"></span></a>Step 5: Run Tests</h3>

<p>In fact, to enable any profiler based mocking tool, you have to set the environment variables. Microsoft Fakes/Typemock Isolator/Telerik JustMock provides the small runner it required, it is true at Prig. So use <code>prig.exe</code> to run the test as follows(continue in the Package Manager Console): </p>

<div class="highlight highlight-powershell"><pre><span class="n">PM</span><span class="p">&gt;</span> <span class="n">cd</span> <span class="p">&lt;</span><span class="n">Your</span> <span class="n">Test</span> <span class="n">Project</span><span class="err">'</span><span class="n">s</span> <span class="n">Output</span> <span class="n">Directory</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">g</span><span class="p">.</span> <span class="n">cd</span> <span class="p">.\</span><span class="n">ConsoleApplicationTest</span><span class="p">\</span><span class="n">bin</span><span class="p">\</span><span class="n">Debug</span><span class="p">)&gt;</span>
<span class="n">PM</span><span class="p">&gt;</span> <span class="n">prig</span> <span class="n">run</span> <span class="n">-process</span> <span class="s2">"C:\Program Files (x86)\NUnit 2.6.3\bin\nunit-console.exe"</span> <span class="n">-arguments</span> <span class="s2">"ConsoleApplicationTest.dll /domain=None /framework=v4.0"</span>
<span class="n">NUnit-Console</span> <span class="n">version</span> <span class="n">2</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">13283</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="n">2002</span><span class="p">-</span><span class="n">2012</span> <span class="n">Charlie</span> <span class="n">Poole</span><span class="p">.</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="n">2002</span><span class="p">-</span><span class="n">2004</span> <span class="n">James</span> <span class="n">W</span><span class="p">.</span> <span class="n">Newkirk</span><span class="p">,</span> <span class="n">Michael</span> <span class="n">C</span><span class="p">.</span> <span class="n">Two</span><span class="p">,</span> <span class="n">Alexei</span> <span class="n">A</span><span class="p">.</span> <span class="n">Vorontsov</span><span class="p">.</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="n">2000</span><span class="p">-</span><span class="n">2002</span> <span class="n">Philip</span> <span class="n">Craig</span><span class="p">.</span>
<span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span><span class="p">.</span>

<span class="n">Runtime</span> <span class="n">Environment</span> <span class="p">-</span> 
   <span class="n">OS</span> <span class="n">Version</span><span class="err">:</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">NT</span> <span class="n">6</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">9200</span><span class="p">.</span><span class="n">0</span>
  <span class="n">CLR</span> <span class="n">Version</span><span class="err">:</span> <span class="n">2</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">50727</span><span class="p">.</span><span class="n">8000</span> <span class="p">(</span> <span class="n">Net</span> <span class="n">3</span><span class="p">.</span><span class="n">5</span> <span class="p">)</span>

<span class="n">ProcessModel</span><span class="err">:</span> <span class="k">Default</span>    <span class="n">DomainUsage</span><span class="err">:</span> <span class="n">None</span>
<span class="n">Execution</span> <span class="n">Runtime</span><span class="err">:</span> <span class="n">v4</span><span class="p">.</span><span class="n">0</span>
<span class="p">...</span>
<span class="n">Tests</span> <span class="n">run</span><span class="err">:</span> <span class="n">3</span><span class="p">,</span> <span class="n">Errors</span><span class="err">:</span> <span class="n">0</span><span class="p">,</span> <span class="n">Failures</span><span class="err">:</span> <span class="n">0</span><span class="p">,</span> <span class="n">Inconclusive</span><span class="err">:</span> <span class="n">0</span><span class="p">,</span> <span class="n">Time</span><span class="err">:</span> <span class="n">0</span><span class="p">.</span><span class="n">0934818542535837</span> <span class="n">seconds</span>
  <span class="n">Not</span> <span class="n">run</span><span class="err">:</span> <span class="n">0</span><span class="p">,</span> <span class="n">Invalid</span><span class="err">:</span> <span class="n">0</span><span class="p">,</span> <span class="n">Ignored</span><span class="err">:</span> <span class="n">0</span><span class="p">,</span> <span class="n">Skipped</span><span class="err">:</span> <span class="n">0</span>

<span class="n">PM</span><span class="p">&gt;</span> 

</pre></div>

<h3>
<a name="final-step-refactoring-and-get-trig-back" class="anchor" href="#final-step-refactoring-and-get-trig-back"><span class="octicon octicon-link"></span></a>Final Step: Refactoring and Get Trig Back!</h3>

<p>If tests have been created, you can refactor illimitably! For example, you probably can find the result of refactoring as follows: </p>

<div class="highlight highlight-cs"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleApplication</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">LifeInfo</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">IsNowLunchBreak</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// 1. Add overload to isolate from external environment then call it from original method.</span>
            <span class="k">return</span> <span class="nf">IsNowLunchBreak</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">IsNowLunchBreak</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">now</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 2. Also, I think the expression '12 &lt;= now.Hour &amp;&amp; now.Hour &lt; 13' is too complex.</span>
            <span class="c1">//    Better this way, isn't it?</span>
            <span class="k">return</span> <span class="n">now</span><span class="p">.</span><span class="n">Hour</span> <span class="p">==</span> <span class="m">12</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// 3. After refactoring, no longer need to use Prig, because you can test this overload.</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>As just described, Prig helps the code that depends on an untestable library gets trig back. I guarantee you will enjoy your development again!!</p>

<h1>
<a name="installation-from-source-code" class="anchor" href="#installation-from-source-code"><span class="octicon octicon-link"></span></a>INSTALLATION FROM SOURCE CODE</h1>

<h2>
<a name="dependency" class="anchor" href="#dependency"><span class="octicon octicon-link"></span></a>DEPENDENCY</h2>

<p>To build this project needs the following dependencies: </p>

<ul>
<li><a href="http://www.visualstudio.com/">Visual Studio 2013(more than Professional Edition)</a></li>
<li>
<a href="http://www.boost.org/">Boost 1.55.0</a><br>
Extract to C:\boost_1_55_0, and will build with the following options(x86 and x64 libs are required):</li>
</ul><pre lang="dos"><code>CMD boost_1_55_0&gt;cd
C:\boost_1_55_0

CMD boost_1_55_0&gt;bootstrap.bat
Building Boost.Build engine

Bootstrapping is done. To build, run:

    .\b2

To adjust configuration, edit 'project-config.jam'.
Further information:
...

CMD boost_1_55_0&gt;.\b2 link=static threading=multi variant=debug,release runtime-link=shared,static -j 4

Building the Boost C++ Libraries.

Performing configuration checks
...

CMD boost_1_55_0&gt;.\b2 link=static threading=multi variant=debug,release runtime-link=shared,static -j 4 --stagedir=.\stage\x64 address-model=64

Building the Boost C++ Libraries.

Performing configuration checks
...
</code></pre>

<ul>
<li>
<a href="https://code.google.com/p/googletest/">Google Test 1.6</a><br>
Extract to C:\gtest-1.6.0, and upgrade C:\gtest-1.6.0\msvc\gtest.sln to Visual Studio 2013. Choose the <code>Build</code> menu, and open <code>Configuration Manager...</code>. On <code>Configuration Manager</code> dialog box, in the <code>Active Solution Platform</code> drop-down list, select the <code>&lt;New...&gt;</code> option. After the <code>New Solution Platform</code> dialog box is opened, in the <code>Type or select the new platform</code> drop-down list, select a 64-bit platform. Then build all(Debug/Release) configurations.</li>
<li>
<a href="http://www.nunit.org/">NUnit 2.6.3.13283</a><br>
Install using with the installer(NUnit-2.6.3.msi).</li>
<li>
<a href="http://www.microsoft.com/en-us/download/details.aspx?id=40754">Modeling SDK for Microsoft Visual Studio 2013</a><br>
Install using with the installer(VS_VmSdk.exe).</li>
<li>
<a href="http://docs.nuget.org/docs/start-here/installing-nuget">NuGet Command-Line Utility</a><br>
Download command line utility <code>nuget.exe</code>, then append its path to the environment variable <code>path</code>.</li>
</ul><h2>
<a name="build" class="anchor" href="#build"><span class="octicon octicon-link"></span></a>BUILD</h2>

<p>After preparing all dependencies, you can build this project in the following steps:</p>

<ol>
<li>Run Visual Studio as Administrator, and open Prig.sln(This sln contains some ATL projects, so the build process will modify registry).</li>
<li>According to the version of the product to use, change the solution configuration and the solution platform and build.</li>
<li>The results are output to <code>$(SolutionDir)$(Configuration)\$(PlatformTarget)\</code>.</li>
</ol><h2>
<a name="registration" class="anchor" href="#registration"><span class="octicon octicon-link"></span></a>REGISTRATION</h2>

<p>Run Developer Command Prompt for VS2013 as Administrator, and register dlls that were output to <code>$(SolutionDir)$(Configuration)\$(PlatformTarget)\</code> to registry and GAC as follows(these are the examples for x86/.NET 3.5, but also another environments are in the same manner): </p>

<pre lang="dos"><code>CMD x86&gt;cd
C:\Prig\Release\x86

CMD x86&gt;regsvr32 /i Urasandesu.Prig.dll

CMD x86&gt;cd "..\..\Release(.NET 3.5)\AnyCPU"

CMD AnyCPU&gt;cd
C:\Prig\Release(.NET 3.5)\AnyCPU

CMD AnyCPU&gt;gacutil /i Urasandesu.NAnonym.dll
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.

Assembly successfully added to the cache

CMD AnyCPU&gt;gacutil /i Urasandesu.Prig.Framework.dll
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.

Assembly successfully added to the cache

CMD AnyCPU&gt;
</code></pre>

<h2>
<a name="unregistration" class="anchor" href="#unregistration"><span class="octicon octicon-link"></span></a>UNREGISTRATION</h2>

<p>Unregistration operation is similar in the registration. Run Developer Command Prompt for VS2013 as Administrator and execute the following commands: </p>

<pre lang="dos"><code>CMD x86&gt;cd
C:\Prig\Release\x86

CMD x86&gt;regsvr32 /u Urasandesu.Prig.dll

CMD x86&gt;cd "..\..\Release(.NET 3.5)\AnyCPU"

CMD AnyCPU&gt;cd
C:\Prig\Release(.NET 3.5)\AnyCPU

CMD AnyCPU&gt;gacutil /u "Urasandesu.Prig.Framework, Version=0.1.0.0, Culture=neutral, PublicKeyToken=acabb3ef0ebf69ce, processorArchitecture=MSIL"
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.


Assembly: Urasandesu.Prig.Framework, Version=0.1.0.0, Culture=neutral, PublicKeyToken=acabb3ef0ebf69ce, processorArchitecture=MSIL
Uninstalled: Urasandesu.Prig.Framework, Version=0.1.0.0, Culture=neutral, PublicKeyToken=acabb3ef0ebf69ce, processorArchitecture=MSIL
Number of items uninstalled = 1
Number of failures = 0

CMD AnyCPU&gt;gacutil /u "Urasandesu.NAnonym, Version=0.2.0.0, Culture=neutral, PublicKeyToken=ce9e95b04334d5fb, processorArchitecture=MSIL"
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.


Assembly: Urasandesu.NAnonym, Version=0.2.0.0, Culture=neutral, PublicKeyToken=ce9e95b04334d5fb, processorArchitecture=MSIL
Uninstalled: Urasandesu.NAnonym, Version=0.2.0.0, Culture=neutral, PublicKeyToken=ce9e95b04334d5fb, processorArchitecture=MSIL
Number of items uninstalled = 1
Number of failures = 0

CMD AnyCPU&gt;
</code></pre>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
